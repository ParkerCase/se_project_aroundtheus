!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this.id=a,this.isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClicks=r}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClicks(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(e){this.isLiked=e,this._renderLikes()}deleteCard(){this._cardElement.remove(),this._element=null}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableSubmit():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}disableSubmit(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(e){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._form,e)}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class s{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}var r=class extends i{constructor(e,t){let{popupSelector:s}=e;super({popupSelector:s}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=[...this._popupElement.querySelectorAll(".modal__input")],this._submitBtn=this._popupElement.querySelector(".modal__button_submit"),this._submitBtnText=this._submitBtn.textContent}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}reset(){this._popupForm.reset()}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close()}};const n={inputSelector:".modal__input",submitButtonSelector:".modal__button_submit",inactiveButtonClass:"modal__button_submit_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},o=document.querySelector("#form-edit-profile"),a=document.querySelector("#form-add-card"),l=document.querySelector("#form-avatar"),d=document.querySelector("#profile-edit-button"),c=document.querySelector("#profile-add-button"),h=document.querySelector("#avatar-button"),u=document.querySelector("#profile-title-input"),_=document.querySelector("#profile-description-input");let m;document.querySelector("#modal-input-type-title"),document.querySelector("#modal-input-type-url"),document.querySelector("#modal-input-type-avatar"),document.querySelector("#delete-card-button");const p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleRes(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getCurrentUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleRes)}updateProfileInfo(e){let{title:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleRes)}updateAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._handleRes)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleRes)}createACard(e){let{title:t,url:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._handleRes)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleRes)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})}).then(this._handleRes)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers,body:JSON.stringify({isLiked:!1})}).then(this._handleRes)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"77570098-8218-4305-94d2-93e61885b891","Content-Type":"application/json"}}),v=new class extends i{constructor(e){super(e),this._previewImage=this._popupElement.querySelector(".modal__image"),this._previewTitle=this._popupElement.querySelector(".modal__card_title")}open(e){this._previewImage.src=e.link,this._previewImage.alt=e.name,this._previewTitle.textContent=e.name,super.open()}close(){super.close()}}({popupSelector:"#preview-card-image-modal"});v.setEventListeners();const b=new r({popupSelector:"#add-card-modal"},(function(e){b.renderLoading(!0),p.createACard(e).then((e=>{C(e),q.disableSubmit(),b.close(),b.reset()})).catch((e=>{console.log(e)})).finally((()=>{b.renderLoading(!1)}))}));b.setEventListeners();const E=new r({popupSelector:"#profile-edit-button-modal"},(function(e){E.renderLoading(!0),p.updateProfileInfo(e).then((e=>{L.setUserInfo(e),E.close(),o.resetValidation(),I.disableSubmit()})).catch((e=>{console.log(e)})).finally((()=>{E.renderLoading(!1)}))}));E.setEventListeners();const S=new class extends i{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._deleteBtn=this._popupElement.querySelector(".modal__button_delete"),this._deleteBtnText=this._deleteBtn.textContent}handleDelete(e){this._handleDeleteSubmit=e}renderDeleting(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading...";this._deleteBtn.textContent=e?t:this._deleteBtnText}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}}("#confirm-delete-modal");S.setEventListeners();const f=new r({popupSelector:"#change-avatar-modal"},(function(e){f.renderLoading(!0),p.updateAvatar(e).then((e=>{L.setAvatarInfo(e),f.close(),l.resetValidation(),B.disableSubmit()})).catch((e=>{console.log(e)})).finally((()=>{f.renderLoading(!1)})),console.log(e)}));f.setEventListeners();const L=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}setAvatarInfo(e){this._avatar.src=e.avatar}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});function g(e){v.open(e)}function y(e){e.isLiked&&p.dislikeCard(e.id).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.log(e)})),e.isLiked||p.likeCard(e.id).then((()=>{e.setIsLiked(!0)})).catch((e=>{console.log(e)}))}function k(e){S.open(),console.log(e.id),S.handleDelete((()=>{S.renderDeleting(!0),p.deleteCard(e.id).then((()=>{e.deleteCard(),S.close()})).catch((e=>{console.error(e)})).finally((()=>{S.renderDeleting(!1)}))}))}function C(t){const s=new e(t,"#card-template",g,k,y).getView();m.addItem(s)}p.getCurrentUserInfo().then((e=>{L.setAvatarInfo(e),L.setUserInfo({name:e.name,about:e.about})})).catch((e=>{console.log(e)})),p.getInitialCards().then((e=>{m=new s({items:e,renderer:C},".cards__list"),m.renderItems(e)})).catch((e=>{console.log(e)})),d.addEventListener("click",(()=>{I.resetValidation();const e=L.getUserInfo();u.value=e.name,_.value=e.about,E.open()})),c.addEventListener("click",(()=>{q.resetValidation(),b.open()})),h.addEventListener("click",(()=>{f.open()}));const I=new t(n,o),q=new t(n,a),B=new t(n,l);I.enableValidation(),q.enableValidation(),B.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUksSUFHcEI1QyxFQUNHMkIsa0JBQ0FiLE1BQU15RCxJQUNMeEUsRUFBVSxJQUFJcEQsRUFDWixDQUNFRSxNQUFPMEgsRUFDUHpILFNBQVUyRixHQUVaLGdCQUVGMUMsRUFBUTdDLFlBQVlxSCxFQUFNLElBRTNCNUIsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQThIcEJsRCxFQUFrQnRHLGlCQUFpQixTQUFTLEtBQzFDK0osRUFBa0J6RyxrQkFDbEIsTUFBTThILEVBQWtCdkIsRUFBU2tCLGNBQ2pDdEUsRUFBa0JWLE1BQVFxRixFQUFnQmxNLEtBQzFDd0gsRUFBd0JYLE1BQVFxRixFQUFnQmpELE1BQ2hEeUIsRUFBaUJwRixNQUFNLElBR3pCK0IsRUFBd0J2RyxpQkFBaUIsU0FBUyxLQUNoRHNKLEVBQWlCaEcsa0JBQ2pCNEYsRUFBYTFFLE1BQU0sSUFHckJnQyxFQUFheEcsaUJBQWlCLFNBQVMsS0FDckN1SyxFQUFZL0YsTUFBTSxJQUtwQixNQUFNdUYsRUFBb0IsSUFBSXNCLEVBQzVCbkYsRUFDQUMsR0FFSW1ELEVBQW1CLElBQUkrQixFQUFjbkYsRUFBb0JFLEdBQ3pEcUUsRUFBc0IsSUFBSVksRUFDOUJuRixFQUNBRyxHQUdGMEQsRUFBa0I1RyxtQkFDbEJtRyxFQUFpQm5HLG1CQUNqQnNILEVBQW9CdEgsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluaywgX2lkLCBpc0xpa2VkIH0sXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrc1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLmlkID0gX2lkO1xuICAgIHRoaXMuaXNMaWtlZCA9IGlzTGlrZWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrcyA9IGhhbmRsZUxpa2VDbGlja3M7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrcyh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe1xuICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgc2V0SXNMaWtlZChpc0xpa2VkKSB7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcblxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZGlzYWJsZVN1Ym1pdCgpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbihvcHRpb25zKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2Zvcm0sIG9wdGlvbnMpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX3ByZXZpZXdUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXJkX3RpdGxlXCIpO1xuICB9XG5cbiAgLy8gRmlndXJlIHRoaXMgb3V0XG4gIG9wZW4oY2FyZERhdGEpIHtcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc3JjID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9wcmV2aWV3VGl0bGUudGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xuXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uX3N1Ym1pdFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dENvbnRlbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gICAgfVxuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZSA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZm9ybVZhbHVlW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZm9ybVZhbHVlO1xuICB9XG5cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIC8vIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uX3N1Ym1pdFwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fc3VibWl0X2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1lZGl0LXByb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tYWRkLWNhcmRcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tYXZhdGFyXCIpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWFkZC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtdHlwZS10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbnB1dC10eXBlLXVybFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtdHlwZS1hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtYnV0dG9uXCIpO1xuIiwiaW1wb3J0IFwiLi4vaW1hZ2VzL2phY3F1ZXMtY291c3RlYXUuanBnXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cENvbmZpcm1EZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQVBJLmpzXCI7XG5pbXBvcnQge1xuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVBZGROZXdDYXJkQnV0dG9uLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYWRkRm9ybUVsZW1lbnQsXG4gIGVkaXRGb3JtRWxlbWVudCxcbiAgYXZhdGFyRm9ybUVsZW1lbnQsXG4gIGF2YXRhckJ1dHRvbixcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxuICBkZWxldGVDYXJkQnV0dG9uLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuLy9pbmRleC5jc3NcIjtcblxubGV0IHNlY3Rpb247XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjc3NTcwMDk4LTgyMTgtNDMwNS05NGQyLTkzZTYxODg1Yjg5MVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlldy1jYXJkLWltYWdlLW1vZGFsXCIsXG59KTtcbnByZXZpZXdJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7XG4gICAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgfSxcbiAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbik7XG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7XG4gICAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LWJ1dHRvbi1tb2RhbFwiLFxuICB9LFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbnByb2ZpbGVFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZGVsZXRlSW1hZ2VNb2RhbCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIik7XG5kZWxldGVJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHtcbiAgICBwb3B1cFNlbGVjdG9yOiBcIiNjaGFuZ2UtYXZhdGFyLW1vZGFsXCIsXG4gIH0sXG4gIGhhbmRsZUNoYW5nZUF2YXRhclxuKTtcbmF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuYXBpXG4gIC5nZXRDdXJyZW50VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRBdmF0YXJJbmZvKHVzZXJEYXRhKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChjYXJkcykgPT4ge1xuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbiAgICAgIH0sXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgcHJvZmlsZUVkaXRNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZUluZm8oaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcbiAgICAgIHByb2ZpbGVFZGl0TW9kYWwuY2xvc2UoKTtcbiAgICAgIGVkaXRGb3JtRWxlbWVudC5yZXNldFZhbGlkYXRpb24oKTtcbiAgICAgIGVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZUVkaXRNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgYWRkQ2FyZE1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5jcmVhdGVBQ2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgICAgIGFkZENhcmRNb2RhbC5jbG9zZSgpO1xuICAgICAgYWRkQ2FyZE1vZGFsLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2hhbmdlQXZhdGFyKGlucHV0VmFsdWVzKSB7XG4gIGF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVBdmF0YXIoaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFySW5mbyhyZXMpO1xuICAgICAgYXZhdGFyTW9kYWwuY2xvc2UoKTtcbiAgICAgIGF2YXRhckZvcm1FbGVtZW50LnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gICAgICBhdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYXZhdGFyTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG4gIGNvbnNvbGUubG9nKGlucHV0VmFsdWVzKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xuICBwcmV2aWV3SW1hZ2VNb2RhbC5vcGVuKGNhcmREYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrcyhjYXJkKSB7XG4gIGlmIChjYXJkLmlzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC5kaXNsaWtlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnNldElzTGlrZWQoZmFsc2UpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxuICBpZiAoIWNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZCh0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGNhcmQpIHtcbiAgZGVsZXRlSW1hZ2VNb2RhbC5vcGVuKCk7XG4gIGNvbnNvbGUubG9nKGNhcmQuaWQpO1xuICBkZWxldGVJbWFnZU1vZGFsLmhhbmRsZURlbGV0ZSgoKSA9PiB7XG4gICAgZGVsZXRlSW1hZ2VNb2RhbC5yZW5kZXJEZWxldGluZyh0cnVlKTtcblxuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICAgIGRlbGV0ZUltYWdlTW9kYWwuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBkZWxldGVJbWFnZU1vZGFsLnJlbmRlckRlbGV0aW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVTdWJtaXQsXG4gICAgaGFuZGxlTGlrZUNsaWNrc1xuICApO1xuICBjb25zdCBjYXJkRWwgPSBjYXJkLmdldFZpZXcoKTtcbiAgcmV0dXJuIGNhcmRFbDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gY3JlYXRlQUNhcmQoY2FyZERhdGEpO1xuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XG59XG5cbi8vIEV2ZW50IExpc3RlbmVyc1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgY29uc3QgY3VycmVudFVzZXJJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8ubmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8uYWJvdXQ7XG4gIHByb2ZpbGVFZGl0TW9kYWwub3BlbigpO1xufSk7XG5cbnByb2ZpbGVBZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZENhcmRNb2RhbC5vcGVuKCk7XG59KTtcblxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhck1vZGFsLm9wZW4oKTtcbn0pO1xuXG4vLyBGb3JtIFZhbGlkYXRvcnNcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBlZGl0Rm9ybUVsZW1lbnRcbik7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRGb3JtRWxlbWVudCk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgYXZhdGFyRm9ybUVsZW1lbnRcbik7XG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX2hhbmRsZVJlcyhyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvciAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBnZXRDdXJyZW50VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cblxuICAvLyBFcnJvclxuICB1cGRhdGVQcm9maWxlSW5mbyh7IHRpdGxlLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiB0aXRsZSxcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXMpO1xuICB9XG4gIC8vIFBhdGNoIGFuZCB1cGRhdGUgYXZhdGFyXG4gIHVwZGF0ZUF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbiAgLy8gR0VUIENhcmRzXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxuICAvLyBQb3N0IGNhcmRzXG4gIGNyZWF0ZUFDYXJkKHsgdGl0bGUsIHVybCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHRpdGxlLFxuICAgICAgICBsaW5rOiB1cmwsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbiAgLy8gREVMRVRFIGNhcmRcbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXMpO1xuICB9XG4gIC8vIFBVVCBvciBsaWtlIGEgY2FyZFxuICBsaWtlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGlzTGlrZWQ6IHRydWUsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbiAgLy8gRGlzbGlrZSBhbmQgRGVsZXRlXG4gIGRpc2xpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaXNMaWtlZDogZmFsc2UsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fZGVsZXRlQnRuID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbl9kZWxldGVcIik7XG4gICAgdGhpcy5fZGVsZXRlQnRuVGV4dCA9IHRoaXMuX2RlbGV0ZUJ0bi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZShoYW5kbGVEZWxldGVTdWJtaXQpIHtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBoYW5kbGVEZWxldGVTdWJtaXQ7XG4gIH1cblxuICByZW5kZXJEZWxldGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0Q29udGVudCA9IFwiTG9hZGluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fZGVsZXRlQnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHRDb250ZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9kZWxldGVCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9kZWxldGVCdG5UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2pvYi50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8odXNlckRhdGEpIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgfVxuXG4gIHNldEF2YXRhckluZm8odXNlckRhdGEpIHtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGlja3MiLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsImlkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGlja3MiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsIl9yZW5kZXJMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInNldElzTGlrZWQiLCJkZWxldGVDYXJkIiwiX2NhcmRFbGVtZW50IiwiX2VsZW1lbnQiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGUiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dEVscyIsImRpc2FibGVTdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJldnQiLCJlbmFibGVWYWxpZGF0aW9uIiwib3B0aW9ucyIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdG4iLCJfc3VibWl0QnRuVGV4dCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dENvbnRlbnQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWUiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJlIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZWRpdEZvcm1FbGVtZW50IiwiYWRkRm9ybUVsZW1lbnQiLCJhdmF0YXJGb3JtRWxlbWVudCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUFkZE5ld0NhcmRCdXR0b24iLCJhdmF0YXJCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0Iiwic2VjdGlvbiIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVSZXMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0Q3VycmVudFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwidXBkYXRlUHJvZmlsZUluZm8iLCJfcmVmMiIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwidXBkYXRlQXZhdGFyIiwiX3JlZjMiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJjcmVhdGVBQ2FyZCIsIl9yZWY0IiwidXJsIiwibGlrZUNhcmQiLCJkaXNsaWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld1RpdGxlIiwiY2FyZERhdGEiLCJhZGRDYXJkTW9kYWwiLCJQb3B1cFdpdGhGb3JtIiwiaW5wdXRWYWx1ZXMiLCJyZW5kZXJDYXJkIiwiYWRkRm9ybVZhbGlkYXRvciIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJwcm9maWxlRWRpdE1vZGFsIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImVkaXRGb3JtVmFsaWRhdG9yIiwiZGVsZXRlSW1hZ2VNb2RhbCIsIl9kZWxldGVCdG4iLCJfZGVsZXRlQnRuVGV4dCIsImhhbmRsZURlbGV0ZSIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJyZW5kZXJEZWxldGluZyIsImF2YXRhck1vZGFsIiwic2V0QXZhdGFySW5mbyIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX2pvYiIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInVzZXJEYXRhIiwiY2FyZCIsImVycm9yIiwiY2FyZHMiLCJjdXJyZW50VXNlckluZm8iLCJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==