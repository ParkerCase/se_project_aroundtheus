!function(){"use strict";class e{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this.id=a,this.isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClicks=r}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClicks(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setIsLiked(e){this.isLiked=e,this._renderLikes()}deleteCard(){this._cardElement.remove(),this._element=null}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this.disableSubmit():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}disableSubmit(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(e){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._form,e)}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}};class s{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}var r=class extends i{constructor(e,t){let{popupSelector:s}=e;super({popupSelector:s}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=[...this._popupElement.querySelectorAll(".modal__input")],this._submitBtn=this._popupElement.querySelector(".modal__button_submit"),this._submitBtnText=this._submitBtn.textContent}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()})),super.setEventListeners()}close(){super.close()}};const n={inputSelector:".modal__input",submitButtonSelector:".modal__button_submit",inactiveButtonClass:"modal__button_submit_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},o=document.querySelector("#form-edit-profile"),a=document.querySelector("#form-add-card"),l=document.querySelector("#form-avatar"),d=document.querySelector("#profile-edit-button"),c=document.querySelector("#profile-add-button"),h=document.querySelector("#avatar-button"),u=document.querySelector("#profile-title-input"),_=document.querySelector("#profile-description-input");let m;document.querySelector("#modal-input-type-title"),document.querySelector("#modal-input-type-url"),document.querySelector("#modal-input-type-avatar"),document.querySelector("#delete-card-button");const p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleRes(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getCurrentUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleRes)}updateProfileInfo(e){let{title:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleRes)}updateAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._handleRes)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleRes)}createACard(e){let{title:t,url:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._handleRes)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleRes)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})}).then(this._handleRes)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers,body:JSON.stringify({isLiked:!1})}).then(this._handleRes)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"77570098-8218-4305-94d2-93e61885b891","Content-Type":"application/json"}}),v=new class extends i{constructor(e){super(e),this._previewImage=this._popupElement.querySelector(".modal__image"),this._previewTitle=this._popupElement.querySelector(".modal__card_title")}open(e){this._previewImage.src=e.link,this._previewImage.alt=e.name,this._previewTitle.textContent=e.name,super.open()}close(){super.close()}}({popupSelector:"#preview-card-image-modal"});v.setEventListeners();const b=new r({popupSelector:"#add-card-modal"},(function(e){b.renderLoading(!0),p.createACard(e).then((e=>{C(e),q.disableSubmit(),b.close(),b.reset()})).catch((e=>{console.log(e)})).finally((()=>{b.renderLoading(!1)}))}));b.setEventListeners();const E=new r({popupSelector:"#profile-edit-button-modal"},(function(e){E.renderLoading(!0),p.updateProfileInfo(e).then((e=>{L.setUserInfo(e),E.close(),o.resetValidation(),I.disableSubmit()})).catch((e=>{console.log(e)})).finally((()=>{E.renderLoading(!1)}))}));E.setEventListeners();const S=new class extends i{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form")}handleDelete(e){this._handleDeleteSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteSubmit()}))}}("#confirm-delete-modal");S.setEventListeners();const f=new r({popupSelector:"#change-avatar-modal"},(function(e){f.renderLoading(!0),p.updateAvatar(e).then((e=>{L.setAvatarInfo(e),f.close(),l.resetValidation(),B.disableSubmit()})).catch((e=>{console.log(e)})).finally((()=>{f.renderLoading(!1)})),console.log(e)}));f.setEventListeners();const L=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(e){this._name.textContent=e.name,this._job.textContent=e.about}setAvatarInfo(e){this._avatar.src=e.avatar}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"});function y(e){v.open(e)}function g(e){e.isLiked&&p.dislikeCard(e.id).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.log(e)})),e.isLiked||p.likeCard(e.id).then((()=>{e.setIsLiked(!0)})).catch((e=>{console.log(e)}))}function k(e){S.open(),console.log(e.id),S.handleDelete((()=>{p.deleteCard(e.id).then((()=>{e.deleteCard(),S.close()})).catch((e=>{console.error(e)}))}))}function C(t){const s=new e(t,"#card-template",y,k,g).getView();m.addItem(s)}p.getCurrentUserInfo().then((e=>{L.setAvatarInfo(e),L.setUserInfo({name:e.name,about:e.about})})).catch((e=>{console.log(e)})),p.getInitialCards().then((e=>{m=new s({items:e,renderer:C},".cards__list"),m.renderItems(e)})).catch((e=>{console.log(e)})),d.addEventListener("click",(()=>{I.resetValidation();const e=L.getUserInfo();u.value=e.name,_.value=e.about,E.open()})),c.addEventListener("click",(()=>{q.resetValidation(),b.open()})),h.addEventListener("click",(()=>{f.open()}));const I=new t(n,o),q=new t(n,a),B=new t(n,l);I.enableValidation(),q.enableValidation(),B.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFpQnBGLE1BQU0sSUFHekIrQixFQUF3QnZHLGlCQUFpQixTQUFTLEtBQ2hEc0osRUFBaUJoRyxrQkFDakI0RixFQUFhMUUsTUFBTSxJQUdyQmdDLEVBQWF4RyxpQkFBaUIsU0FBUyxLQUNyQ29LLEVBQVk1RixNQUFNLElBS3BCLE1BQU11RixFQUFvQixJQUFJbUIsRUFDNUJoRixFQUNBQyxHQUVJbUQsRUFBbUIsSUFBSTRCLEVBQWNoRixFQUFvQkUsR0FDekRrRSxFQUFzQixJQUFJWSxFQUM5QmhGLEVBQ0FHLEdBR0YwRCxFQUFrQjVHLG1CQUNsQm1HLEVBQWlCbkcsbUJBQ2pCbUgsRUFBb0JuSCxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQVBJLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0ZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBfaWQsIGlzTGlrZWQgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tzXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuaWQgPSBfaWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2tzID0gaGFuZGxlTGlrZUNsaWNrcztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2tzKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICAgIGxpbms6IHRoaXMuX2xpbmssXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuXG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5kaXNhYmxlU3VibWl0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBkaXNhYmxlU3VibWl0KCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnModGhpcy5fZm9ybSwgb3B0aW9ucyk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcHJldmlld1RpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcmRfdGl0bGVcIik7XG4gIH1cblxuICAvLyBGaWd1cmUgdGhpcyBvdXRcbiAgb3BlbihjYXJkRGF0YSkge1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5zcmMgPSBjYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5hbHQgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX3ByZXZpZXdUaXRsZS50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9LCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIildO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25fc3VibWl0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0Q29udGVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcbiAgICB9XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBmb3JtVmFsdWVbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBmb3JtVmFsdWU7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uX3N1Ym1pdFwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fc3VibWl0X2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1lZGl0LXByb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tYWRkLWNhcmRcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tYXZhdGFyXCIpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWFkZC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1idXR0b25cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtdHlwZS10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbnB1dC10eXBlLXVybFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtdHlwZS1hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtYnV0dG9uXCIpO1xuIiwiaW1wb3J0IFwiLi4vaW1hZ2VzL2phY3F1ZXMtY291c3RlYXUuanBnXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cENvbmZpcm1EZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQVBJLmpzXCI7XG5pbXBvcnQge1xuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVBZGROZXdDYXJkQnV0dG9uLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYWRkRm9ybUVsZW1lbnQsXG4gIGVkaXRGb3JtRWxlbWVudCxcbiAgYXZhdGFyRm9ybUVsZW1lbnQsXG4gIGF2YXRhckJ1dHRvbixcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxuICBkZWxldGVDYXJkQnV0dG9uLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgXCIuLy9pbmRleC5jc3NcIjtcblxubGV0IHNlY3Rpb247XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjc3NTcwMDk4LTgyMTgtNDMwNS05NGQyLTkzZTYxODg1Yjg5MVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlldy1jYXJkLWltYWdlLW1vZGFsXCIsXG59KTtcbnByZXZpZXdJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7XG4gICAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgfSxcbiAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbik7XG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICB7XG4gICAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LWJ1dHRvbi1tb2RhbFwiLFxuICB9LFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbnByb2ZpbGVFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZGVsZXRlSW1hZ2VNb2RhbCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIik7XG5kZWxldGVJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHtcbiAgICBwb3B1cFNlbGVjdG9yOiBcIiNjaGFuZ2UtYXZhdGFyLW1vZGFsXCIsXG4gIH0sXG4gIGhhbmRsZUNoYW5nZUF2YXRhclxuKTtcbmF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuYXBpXG4gIC5nZXRDdXJyZW50VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRBdmF0YXJJbmZvKHVzZXJEYXRhKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChjYXJkcykgPT4ge1xuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbiAgICAgIH0sXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgcHJvZmlsZUVkaXRNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZUluZm8oaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcbiAgICAgIHByb2ZpbGVFZGl0TW9kYWwuY2xvc2UoKTtcbiAgICAgIGVkaXRGb3JtRWxlbWVudC5yZXNldFZhbGlkYXRpb24oKTtcbiAgICAgIGVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZUVkaXRNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgYWRkQ2FyZE1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5jcmVhdGVBQ2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICAvLyBhZGRGb3JtRWxlbWVudC5yZXNldFZhbGlkYXRpb24oKTtcbiAgICAgIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdCgpO1xuICAgICAgYWRkQ2FyZE1vZGFsLmNsb3NlKCk7XG4gICAgICAvLyB0aGUgY29kZSBiZWxvdyB0aGlzIGlzIG9ubHkgaWYgdGhlIG9uZSBhYm92ZSBkb2VzIG5vdCB3b3JrXG4gICAgICBhZGRDYXJkTW9kYWwucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZE1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDaGFuZ2VBdmF0YXIoaW5wdXRWYWx1ZXMpIHtcbiAgYXZhdGFyTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihpbnB1dFZhbHVlcylcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXJJbmZvKHJlcyk7XG4gICAgICBhdmF0YXJNb2RhbC5jbG9zZSgpO1xuICAgICAgYXZhdGFyRm9ybUVsZW1lbnQucmVzZXRWYWxpZGF0aW9uKCk7XG5cbiAgICAgIGF2YXRhckZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgY29uc29sZS5sb2coaW5wdXRWYWx1ZXMpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHByZXZpZXdJbWFnZU1vZGFsLm9wZW4oY2FyZERhdGEpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2tzKGNhcmQpIHtcbiAgaWYgKGNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmRpc2xpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZChmYWxzZSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG4gIGlmICghY2FyZC5pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKHRydWUpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoY2FyZCkge1xuICBkZWxldGVJbWFnZU1vZGFsLm9wZW4oKTtcbiAgY29uc29sZS5sb2coY2FyZC5pZCk7XG4gIGRlbGV0ZUltYWdlTW9kYWwuaGFuZGxlRGVsZXRlKCgpID0+IHtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgICBkZWxldGVJbWFnZU1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBkYXRhLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZVN1Ym1pdCxcbiAgICBoYW5kbGVMaWtlQ2xpY2tzXG4gICk7XG4gIGNvbnN0IGNhcmRFbCA9IGNhcmQuZ2V0VmlldygpO1xuICByZXR1cm4gY2FyZEVsO1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVBQ2FyZChjYXJkRGF0YSk7XG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbn1cblxuLy8gRXZlbnQgTGlzdGVuZXJzXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBjb25zdCBjdXJyZW50VXNlckluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IGN1cnJlbnRVc2VySW5mby5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGN1cnJlbnRVc2VySW5mby5hYm91dDtcbiAgcHJvZmlsZUVkaXRNb2RhbC5vcGVuKCk7XG59KTtcblxucHJvZmlsZUFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcbn0pO1xuXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyTW9kYWwub3BlbigpO1xufSk7XG5cbi8vIEZvcm0gVmFsaWRhdG9yc1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGVkaXRGb3JtRWxlbWVudFxuKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGFkZEZvcm1FbGVtZW50KTtcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBhdmF0YXJGb3JtRWxlbWVudFxuKTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlUmVzKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEN1cnJlbnRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxuXG4gIC8vIEVycm9yXG4gIHVwZGF0ZVByb2ZpbGVJbmZvKHsgdGl0bGUsIGRlc2NyaXB0aW9uIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHRpdGxlLFxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbiAgLy8gUGF0Y2ggYW5kIHVwZGF0ZSBhdmF0YXJcbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxuICAvLyBHRVQgQ2FyZHNcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXMpO1xuICB9XG4gIC8vIFBvc3QgY2FyZHNcbiAgY3JlYXRlQUNhcmQoeyB0aXRsZSwgdXJsIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogdGl0bGUsXG4gICAgICAgIGxpbms6IHVybCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxuICAvLyBERUxFVEUgY2FyZFxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlcyk7XG4gIH1cbiAgLy8gUFVUIG9yIGxpa2UgYSBjYXJkXG4gIGxpa2VDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaXNMaWtlZDogdHJ1ZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxuICAvLyBEaXNsaWtlIGFuZCBEZWxldGVcbiAgZGlzbGlrZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBpc0xpa2VkOiBmYWxzZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwQ29uZmlybURlbGV0ZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZShoYW5kbGVEZWxldGVTdWJtaXQpIHtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBoYW5kbGVEZWxldGVTdWJtaXQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHVzZXJEYXRhKSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XG4gIH1cblxuICBzZXRBdmF0YXJJbmZvKHVzZXJEYXRhKSB7XG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2tzIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJpZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2tzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJfcmVuZGVyTGlrZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJzZXRJc0xpa2VkIiwiZGVsZXRlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9lbGVtZW50IiwiZ2V0VmlldyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRFbHMiLCJkaXNhYmxlU3VibWl0IiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZXZ0IiwiZW5hYmxlVmFsaWRhdGlvbiIsIm9wdGlvbnMiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHRDb250ZW50IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJyZXNldCIsInZhbGlkYXRpb25TZXR0aW5ncyIsImVkaXRGb3JtRWxlbWVudCIsImFkZEZvcm1FbGVtZW50IiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGROZXdDYXJkQnV0dG9uIiwiYXZhdGFyQnV0dG9uIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInNlY3Rpb24iLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEN1cnJlbnRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInVwZGF0ZVByb2ZpbGVJbmZvIiwiX3JlZjIiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInVwZGF0ZUF2YXRhciIsIl9yZWYzIiwiYXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiY3JlYXRlQUNhcmQiLCJfcmVmNCIsInVybCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwicHJldmlld0ltYWdlTW9kYWwiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdUaXRsZSIsImNhcmREYXRhIiwiYWRkQ2FyZE1vZGFsIiwiUG9wdXBXaXRoRm9ybSIsImlucHV0VmFsdWVzIiwicmVuZGVyQ2FyZCIsImFkZEZvcm1WYWxpZGF0b3IiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwicHJvZmlsZUVkaXRNb2RhbCIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJlZGl0Rm9ybVZhbGlkYXRvciIsImRlbGV0ZUltYWdlTW9kYWwiLCJoYW5kbGVEZWxldGUiLCJoYW5kbGVEZWxldGVTdWJtaXQiLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiYXZhdGFyTW9kYWwiLCJzZXRBdmF0YXJJbmZvIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfam9iIiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwidXNlckRhdGEiLCJjYXJkIiwiZXJyb3IiLCJjYXJkcyIsImN1cnJlbnRVc2VySW5mbyIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9